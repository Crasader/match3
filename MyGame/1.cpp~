#include <fstream>
#include <ostream>
#include <iostream>

using namespace std;

#define KEY 3

int main (){
	{
		ifstream ifo("test.json");
		ofstream ofile("test1.json",ios::trunc);
		string buf;
		while((not ifo.eof()) and (not ifo.fail())){
			string res;
			if (getline(ifo,buf) == 0)return 1;
		cout<<"!!!!"<<endl;
			cout<<buf;
			for (int i = 0; i < buf.size(); i++){
				char b = (char)buf[i] ;
				switch(b){
					case 33 ... 126-KEY : 
						b += KEY;
						break ;
					case 127-KEY ... 126 :
						b -= 126 - 33 - KEY;
						break;
					default :
						;
				}
				cout<<b;
				res += b;
			}
			cout<<res;
			ofile<<res;
		}
		ifo.close();
		ofile.close();
	}
	{
		ifstream ifo("test1.json");
		ofstream ofile("test2.json",ios::trunc);
		string buf;
		while((not ifo.eof()) and (not ifo.fail())){
			string res;
			if (getline(ifo,buf) == 0)return 1;
			for (int i = 0; i < buf.size(); i++){
				char b = (char)buf[i] ;
				switch(b){
					case 33 ... 33+KEY : 
						b += 126 - 33 - KEY;
						break ;
					case 34+KEY ... 126 :
						b -= KEY;
						break;
					default :
						;
				}
				cout<<b;
				res += b;
			}
			cout<<res;
			ofile<<res;
		}
		ifo.close();
		ofile.close();
	}
}
